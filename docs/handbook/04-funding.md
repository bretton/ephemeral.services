# Funding

## Multiple Deposits

When open a new channel, the entire input tx is used. If the channel is smaller than the size of the input, the remainder bitcoin are locked until 3 blocks have confirmed. Only then can a new channel be opened with the balance.

You can mitigate delays in opening several channels by funding your node in several smaller transactions, at a higher transaction cost, and benefit of opening multiple channels at once and having them go live within 3 blocks.

Or you can fund your node with a single large transaction, and spend several hours opening up 5 or more channels.

## Funding to bech32

We want to ensure our node is funded on bech32 addy, or with `lnd` known as `lncli newaddress p2wkh`

We also want to ensure multiple inputs, so several funding transactions, in order to open multiple channels simultaneously. 

This means funding n bech32 addresses with 0.3 btc ($1000 @ 2018-12-18 prices) split into 0.03 transaction sizes. 

## Funding bitcoind, then bech32

Not all exchanges and wallets will support sending bitcoin directly to an address generated by a LN node. You may be required to first send Bitcoin to your bitcoind node with a regular bitcoin address, and them from there send to your LN node with a bech32 address.

You can do a single funding transaction to bitcoind, and 10 funding transactions to LN.

## What does this cost?

We have a known potential fee range for a regular sized transaction of:

Low     0.00001350 BTC
Normal: 0.00007232 BTC (5 times higher)
High:   0.00204945 BTC (150 times higher)

Each bitcoind funding transaction to a normal pre-segwit address can cost 0.00001350 to 0.00204945 BTC.

Each LN funding transaction to a bech32 address can cost 0.00002213 to 0.00334163 BTC.

A sample funding round of several transactions follows, with the total fees to open a $10 channel, funded from non-segwit wallet, to bitcoind, to LND, and open channel = (0.00003778+0.00002213+0.00002787) = 0.00008778 BTC, and time taken 3 hours because fees were lower than required. 

Perhaps ten bech32 funding transactions could be batched for lower fees?

Alternatively, you may be looking at 0.00022130 BTC in fees to fund ten (10) bech32 inputs for your LN node to be able to open 10 channels at once. 

recap:

exchange to bitcoind: 0.00007232 BTC PLUS
bitcoind to ln node ten times: 0.00022130 BTC
channel opening fee 1% capacity ten times: 0.00027870 BTC

Total fees for ten ~$100 channels after two funding rounds from legacy to bitcoind to bech32 on LN node is likely around 0.00057232 BTC, or $2.00 at current prices, without batching. 

As long as fees are low, this is a feasible approach. However if fees rise 10x, or 150x, re-evaluation may be needed.

To-do:
* review https://en.bitcoin.it/wiki/Techniques_to_reduce_transaction_fees
* build a script to fund 10 LN bech32 wallet addresses in a single batched transaction, by obtaining 10 addresses, calculating 1/10th balances to send, and sending in a single transaction

## How long does it take?

It can take anything from 30 to 360 minutes to fund your node in the fashion outlined in this document. 

## Outgoing Channels

10 * channels of $100, of which two are channels to our other nodes.

## Incoming Channels

Any number of $10+ to max channels




